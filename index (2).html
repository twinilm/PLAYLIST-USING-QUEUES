<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Beautiful Audio Queue Player</title>
    <style>
        body {
            margin: 0;
            font-family: Poppins, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .player-container {
            width: 380px;
            background: rgba(255, 255, 255, 0.08);
            padding: 24px;
            border-radius: 20px;
            backdrop-filter: blur(12px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            animation: fadeIn 0.7s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            text-align: center;
            font-size: 1.4rem;
            margin-bottom: 10px;
            letter-spacing: 1px;
            font-weight: 600;
        }

        input[type="file"] {
            background: #ffffff20;
            padding: 10px;
            width: 100%;
            border-radius: 12px;
            cursor: pointer;
            margin-bottom: 14px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 14px;
            margin-top: 10px;
        }

        button {
            background: #ffffff25;
            border: none;
            padding: 10px 18px;
            border-radius: 12px;
            color: #fff;
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.2s;
        }

        button:hover {
            background: #ffffff35;
            transform: scale(1.05);
        }

        button:active {
            transform: scale(0.95);
        }

        .queue-title {
            margin-top: 16px;
            font-weight: 500;
            opacity: 0.85;
        }

        ul {
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding: 0;
            list-style: none;
        }

        li {
            padding: 10px;
            margin-bottom: 8px;
            background: #ffffff10;
            border-radius: 12px;
            cursor: pointer;
            transition: 0.2s ease;
        }

        li:hover {
            background: #ffffff20;
        }

        li.active {
            background: #4f46e5;
            font-weight: bold;
        }

        #nowPlaying {
            text-align: center;
            margin-top: 12px;
            font-size: 0.95rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>

<div class="player-container">

    <h2>My Music Player üéµ</h2>

    <input type="file" id="fileInput" multiple accept="audio/*">

    <div class="controls">
        <button id="prevBtn">‚èÆ</button>
        <button id="playPause">‚èØ</button>
        <button id="nextBtn">‚è≠</button>
    </div>

    <label style="display:flex; justify-content:center; margin-top:10px;">
        <input type="checkbox" id="loopToggle" checked>
        &nbsp;Loop Queue
    </label>

    <p id="nowPlaying">Now playing: (none)</p>

    <p class="queue-title">Playlist Queue</p>
    <ul id="queueList"></ul>

</div>

<script>
/* ---------------- Queue Class ---------------- */
class AudioQueue {
    constructor() {
        this.items = [];
        this.currentIndex = 0;
    }

    enqueue(x) { this.items.push(x); }
    current() { return this.items[this.currentIndex] || null; }
    size() { return this.items.length; }

    next(loop = true) {
        if (this.currentIndex < this.items.length - 1)
            this.currentIndex++;
        else if (loop)
            this.currentIndex = 0;
        return this.current();
    }

    prev(loop = true) {
        if (this.currentIndex > 0)
            this.currentIndex--;
        else if (loop)
            this.currentIndex = this.items.length - 1;
        return this.current();
    }
}

/* ---------------- Player Logic ---------------- */
const queue = new AudioQueue();
const audio = new Audio();
let currentURL = null;
let loopQueue = true;

// DOM elements
const fileInput = document.getElementById("fileInput");
const playPause = document.getElementById("playPause");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const loopToggle = document.getElementById("loopToggle");
const queueList = document.getElementById("queueList");
const nowPlaying = document.getElementById("nowPlaying");

/* ---------------- File Upload ---------------- */
fileInput.addEventListener("change", () => {
    const files = Array.from(fileInput.files);

    files.forEach(f => {
        if (f.type.startsWith("audio/")) {
            queue.enqueue(f);
        }
    });

    renderQueue();
    if (queue.size() === 1) loadAndPlay();
});

/* ---------------- UI Controls ---------------- */
playPause.addEventListener("click", () => {
    if (audio.paused) audio.play();
    else audio.pause();
});

nextBtn.addEventListener("click", () => {
    queue.next(loopQueue);
    loadAndPlay();
});

prevBtn.addEventListener("click", () => {
    queue.prev(loopQueue);
    loadAndPlay();
});

loopToggle.addEventListener("change", (e) => {
    loopQueue = e.target.checked;
});

/* Auto go to next song */
audio.addEventListener("ended", () => {
    queue.next(loopQueue);
    loadAndPlay();
});

/* ---------------- Load & Play ---------------- */
function loadAndPlay() {
    const file = queue.current();
    if (!file) return;

    // Revoke old object URL
    if (currentURL) URL.revokeObjectURL(currentURL);

    currentURL = URL.createObjectURL(file);
    audio.src = currentURL;
    audio.play();

    nowPlaying.textContent = "Now playing: " + file.name;

    renderQueue();
}

/* ---------------- Render Queue ---------------- */
function renderQueue() {
    queueList.innerHTML = "";

    queue.items.forEach((file, index) => {
        const li = document.createElement("li");
        li.textContent = file.name;

        if (index === queue.currentIndex)
            li.classList.add("active");

        li.addEventListener("click", () => {
            queue.currentIndex = index;
            loadAndPlay();
        });

        queueList.appendChild(li);
    });
}
</script>

</body>
</html>